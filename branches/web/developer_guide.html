<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
    <style type="text/css" media="screen">
        body {
        font-family: Verdana, Arial, Helvetica, sans-serif;
        font-size: 12px;
        text-align: justify;
        background-color: #FFFFFF;
        }
        th   {
        font-family: Verdana, Arial, Helvetica, sans-serif;
        font-size: 9pt;
        font-weight: bold;
        background-color: #000099;
        color: #FFFFFF;
        }
        td   {  
        font-family: Verdana, Arial, Helvetica, sans-serif;
        font-size: 9pt;
        }
        form   {  
        font-family: Verdana, Arial, Helvetica, sans-serif;
        font-size: 9pt;
        }
        h1   {  
        font-family: Verdana, Arial, Helvetica, sans-serif;
        font-size: 16pt;
        font-weight: bold;
        }
        h3   {  
        font-family: Verdana, Arial, Helvetica, sans-serif;
        font-size: 14pt;
        font-weight: bold;
        }
        h3   {  
        font-family: Verdana, Arial, Helvetica, sans-serif;
        font-size: 12pt;
        font-weight: bold;
        }
        h4   { 
        font-family: Verdana, Arial, Helvetica, sans-serif;
        font-size: 10pt;
        font-weight: bold;
        }
        h5   {
        font-family: Verdana, Arial, Helvetica, sans-serif;
        font-size: 8pt;
        font-weight: bold;
        }
        h6   {
        font-family: Verdana, Arial, Helvetica, sans-serif;
        font-size: 6pt;
        font-weight: bold;
        }
        .tiny {  font-family: Verdana, Arial, Helvetica, sans-serif; color: #000000;font-size: 8pt;}
    .Style1 {color: #333333}
    </style>
    <body>
        <table width="100%"  border="0">
          <tr>
            <td valign="top" bgcolor="#CCCCCC">
              <br><br>
              <p><strong><a href="#tuto1">Tutorial 1: Using metadata object to generate buffers</a></strong></p>
              <p><strong><a href="#tuto1">Tutorial 2: Using metadata object to retrieve objects on the fly</a></strong></p>
              -->
            </td>
            <td valign="top">
              <h2><a name="top"></a>Developer Guide</h2>
              <p>This document gives some hints to integrate KaboumServer in am exsting Java Web Application
              and to develop business logic on top of KaboumServer API.</p>
              <!-- menu gauche -->
              <h3><a name="integration"/>Integrating KaboumServer libraries into an existing application<a href="#top"><img src="images/top_1.gif" width="28" height="28" border="0"></a></h3>
              <ul>
                <li><strong>Build KaboumServer or get binary distribution (see Installation Guide)</strong></li>
                <li><strong>Copy KabomServer libraries into project's library, add these libraries to the
                project's classpath.</strong></li>
                <li><strong>Download Geotools 2.4.4 binary distribution and add all the Geotools jar to the project's classpath</strong></li>
              </ul>                            
              <h3><a name="copyfile"><a name="copy"/>Copie des fichiers de l'application <a href="#top"><img src="images/top_1.gif" width="28" height="28" border="0"></a></h3>
              <p>L'ensemble Kaboum se compose d'une partie cliente: 
              Applet + API Javascript et d'une partie serveur: biblioth&egrave;ques Java, 
              API KaboumServer, configuration de la servlet dans le fichier de configuration de la webapp 
              <code>web.xml</code>.</p>

              <h5>Partie cliente</h5>
              <p>Elle se compose de l'applet kaboum.jar et du fichier Javascript kaboum.api. 
              Ces fichiers doivent etre int&eacute;gr&eacute;s dans la page web qui contiendra l'applet Kaboum. </p>
              <p>Copier les fichiers kaboum.jar et kaboum.js dans un r&eacute;pertoire qui sera accessible 
              depuis la page web contenant l'applet. Ces fichiers peuvent &eacute;galement 
              &ecirc;tre copi&eacute;s &agrave; la racine des pages web, mais pour une meilleure organisation, 
              il est conseill&eacute; de cr&eacute;er un sous-r&eacute;pertoire, par exemple &quot;<code>kaboum</code>&quot;.</p>
              <h5>Partie serveur</h5>
              <p>Elle se compose de biblioth&egrave;ques java de deux types: 
              celles externes n&eacute;cessaires au projet KaboumServer et celle contenant le code de 
              KaboumServer proprement dit (servlet et classes).</p>
              <p>
                  KaboumServer se base sur GeoTools 2.4.4 pour manipuler les objets g&eacute;om&eacute;triques.
                  Les librairies geotools ne sont pas livr&eacute;es avec KaboumServer mais sont telechargeables ici:
                  <a href="http://geotools.codehaus.org/">geotools.codehaus.org</a>.<br/>
                  GeoTools integre la librairie JTS qui est en charge de travailler avec les geometries.
              </p>

              <h3><a name="config"></a>Configuration de la servlet KaboumFeatureServlet et des filtres <a href="#top"><img src="images/top_1.gif" width="28" height="28" border="0"></a></h3>
              <ul>
                <li>Editer le fichier web.xml de la webapp.</li>
                <li>Y copier les blocs &lt;filter&gt;, &lt;filter-mapping&gt;, &lt;servlet&gt; et  &lt;servlet-mapping&gt; contenus dans le fichier web.xml.example.</li>
                <li>Ajuster les param&egrave;tres de ces &eacute;l&eacute;ments de configuration, notamment le nom de la classe impl&eacute;mentant l'interface GeometryAccess que l'on d&eacute;sire utiliser &agrave; la place de celle fournie avec KaboumServer</li>
                <li>Ajouter tous les fichiers .jar copi&eacute;s dans le r&eacute;pertoire lib dans le classpath de la webapp. </li>
              </ul>              
              <h5>Param&egrave;tres du filtre de compression</h5>
              <p>KaboumServer est fournie avec un filtre Servlet permettant de r&eacute;aliser la compression &agrave; la vol&eacute;e des donn&eacute;es envoy&eacute;es &agrave; l'applet Kaboum. Il est fortement conseill&eacute; de compresser les donn&eacute;es &agrave; envoyer (leur taille est r&eacute;duite d'environ 1/3).</p>
              <p><em> Note: </em>l'applet Kaboum g&egrave;re automatiquement le flux re&ccedil;u et est capable de le d&eacute;compresser si n&eacute;cessaire. Il n'y a donc pas de configuration concernant la compression des donn&eacute;es sur l'applet Kaboum. </p>
              <p>Les param&egrave;tres du filtre de compression sont:</p>
              <ul>
                <li><code>compressionThreshold</code>: la taille, en bits du buffer utilis&eacute; pour &eacute;crire les donn&eacute;es &agrave; compresser (0 = pas de compression).</li>
                <li><code>debug</code>: un chiffre de 0 (pas de debug) &agrave; 3 (debug maximum). Les informations de debug sont &eacute;crites dans la console de sortie standard. Attention, les niveaux de debug 2 et 3 &eacute;crivent potentiellement beaucoup d'information et nuisent &agrave; la performances de l'application.</li>
              </ul>              <h5>Param&egrave;tres de la servlet KaboumFeatureServlet </h5>              
              <ul>
                <li><code>KaboumGeometryAccessClass</code>: le nom complet de la classe impl&eacute;mentant l'interface GeometryAccess qui sera utilis&eacute;e pour acc&eacute;der aux donn&eacute;es. Cette class doit &ecirc;tre dans le classpath de la webapp. </li>
                <li><code>KaboumPropertiesFile</code>: le chemin et le nom, relatif au contexte de la webapp, du fichier de configuration de KaboumServer. Un fichier d'exemple est fourni et peut &ecirc;tre utilis&eacute; comme guide pour cr&eacute;er son propre fichier de configuration.</li>
              </ul>              
              <h3><a name="appletintegration"/>Int&eacute;gration de l'applet Kaboum <a href="#top"><img src="images/top_1.gif" width="28" height="28" border="0"></a></h3>
              <p>L'int&eacute;gration de Kaboum dans une page HTML se fait &agrave; deux niveaux:</p>
              <h5>1&deg;) Ecriture du code &lt;applet&gt;</h5>
              <p>Ex de code applet:</p>
              <p> <code>&lt;applet code=&quot;org.kaboum.Kaboum.class&quot;<br>
              </code><code> codebase=&quot;./kaboum&quot; <br>
              archive=&quot;kaboum.jar&quot; <br>
              alt=&quot;kaboum applet&quot; <br>
              align=&quot;CENTER&quot; <br>
              height=500 <br>
              width=500 <br>
              MAYSCRIPT <br>
              name=&quot;kaboum&quot;&gt;<br>
&lt;param name=&quot;MAPFILE_PATH&quot; value=&quot;D:/Code/Java/paclux/KaboumServer/web/data/mapserver/test.map&quot;&gt;<br>
&lt;param name=&quot;MAPFILE_EXTENT&quot; value=&quot;47679.9453125,1620477.875,1197822.0,2677440.5&quot;&gt;<br>
&lt;param name=&quot;KABOUM_MAPSERVER_CGI_URL&quot; value=&quot;http://localhost/cgi-bin/mapserv.exe&quot;&gt;<br>
&lt;param name=&quot;KABOUM_FEATURESERVER_URL&quot; value=&quot;http://localhost:8084/KaboumServer/KaboumFeatureServlet&quot;&gt;<br>
&lt;param name=&quot;KABOUM_BUSY_IMAGE_URL&quot; value=&quot;http://localhost/apache_pb2_ani.gif&quot;&gt;<br>
&lt;param name=&quot;KABOUM_USE_LIVECONNECT&quot; value=&quot;TRUE&quot;&gt;<br>
&lt;param name=&quot;KABOUM_REFERENCE_IS_APPLET&quot; value=&quot;FALSE&quot;&gt;<br>
&lt;param name=&quot;KABOUM_DEBUG_MODE&quot; value=&quot;TRUE&quot;&gt;<br>
&lt;param name=&quot;KABOUM_BACKGROUND_COLOR&quot; value=&quot;255,255,255&quot;&gt;<br>
&lt;param name=&quot;KABOUM_LANG&quot; value=&quot;UK&quot;&gt;<br>
&lt;param name=&quot;KABOUM_DEFAULT_OPMODE&quot; value=&quot;ZOOMIN&quot;&gt;<br>
&lt;param name=&quot;KABOUM_OPMODES_LIST&quot; value=&quot;ZOOMIN,GEOMETRY,SELECTION,DISTANCE,MODIFY,BOXSELECTION,LINESTRING,PAN,POLYGON&quot;&gt;<br>
&lt;param name=&quot;KABOUM_COORDINATE_PRECISION&quot; value=&quot;1&quot;&gt;<br>
&lt;param name=&quot;KABOUM_SEND_POSITION_COORDINATES_TO_JS&quot; value=&quot;false&quot;&gt;<br>
&lt;param name=&quot;MAPFILE_UNITS&quot; value=&quot;MS_METERS&quot;&gt;<br>
&lt;param name=&quot;SURFACE_UNITS&quot; value=&quot;MS_ARE&quot;&gt;<br>
&lt;param name=&quot;LAYERS&quot; value=&quot;img1,departements,cities,rails&quot;&gt;<br>
&lt;/applet&gt; </code></p>
              <p>Se r&eacute;f&eacute;rer &agrave; la documentation Kaboum pour la liste de tous les param&egrave;tres et de leur valeur. </p>
              <h5>2&deg;) Int&eacute;gration des composants Javascript</h5>
              <p>On peut int&eacute;grer &agrave; la page web boutons, controle de couches, echelles dynamiques, etc. Ces composants sont g&eacute;n&eacute;r&eacute;s dans le fichier kaboum.js et s'ajoutent &agrave; la page en appelant des methodes Javascript (cf. la documentation de l'API Kaboum JS).</p>
              <p>Ex. pour int&eacute;grer une barre d'outil:</p>
              <p><code>&lt;script&gt;<br>
              kNewButton('kaboum/images/zoomin', 'Zoom In', 'modal', 'ZOOMIN', 28, 28);<br>
              kNewButton('kaboum/images/zoomout', 'Zoom out', 'modal', 'ZOOMOUT', 28, 28);<br>
              kNewButton('kaboum/images/pan', 'Pan the map', 'modal', 'PAN', 28, 28);<br>
              kNewButton('kaboum/images/back', 'previous map location', 'action', 'BACK', 28, 28);<br>
              kNewButton('kaboum/images/forward', 'next map location', 'action', 'FORWARD', 28, 28);<br>
              kNewButton('kaboum/images/home', 'Return to home page', 'action', 'HOME', 28, 28);<br>
              kNewButton('kaboum/images/info', 'Layers information', 'modal', 'QUERY', 28, 28);<br>
              kNewButton('kaboum/images/select', 'Selection', 'modal', 'MULTISELECTION', 28, 28);<br>
              kNewButton('kaboum/images/distance', 'measure distances', 'modal', 'DISTANCE', 28, 28);<br>
              kNewButton('kaboum/images/surface', 'measure surfaces', 'modal', 'SURFACE', 28, 28);<br>
              kNewButton('kaboum/images/help', 'Debug mapserver', 'action', 'JS_DEBUG', 28, 28);<br>
&lt;/script&gt; </code></p>              
              <h3><a name="tests"/>Test<a href="#top"><img src="images/top_1.gif" width="28" height="28" border="0"></a></h3>
            <p>D&eacute;marrer la webapp et naviguer vers la page contenant l'applet Kaboum. Si la configuration est bonne, les donn&eacute;es g&eacute;ographiques configur&eacute;es dans le fichier de conf doivent apparaitre dans l'applet. </p>
            <p>En cas d'erreur, v&eacute;rifier les points suivants:</p>
            <ul>
              <li>Le nom et le chemin de l'applet Kaboum. Il doit pointer vers un repertoire contenant kaboum.jar</li>
              <li>Si le fichier kaboum.js est bien inclus dans la page web contenant l'applet Kaboum.</li>
              <li>Si la ou les sources de donn&eacute;es sont accessibles depuis la webapp (fichiers, bases de donn&eacute;es, mot de passe, etc.)</li>
              <li>Si le fichier de configuration de KaboumServer est correct </li>
            </ul>            
            <p class="tiny Style1">Nicolas Ribot - 2005/10/15 </p></td>
          </tr>
        </table>
    </form>
    </body>
</html>
