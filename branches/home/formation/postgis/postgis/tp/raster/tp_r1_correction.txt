____________
TP Raster 1:
____
But: 
charger un raster dans Postgis, controler la ou les tables crées.

_______
Etapes:

0°) (Si la base de données "tp" n'existe pas, la créer et y ajouter Postgis)

(en ligne de commande:)
createdb tp
psql tp

(dans psql:)
create extension postgis;

1°) Charger l'image située dans le repertoire formation_postgis/data/raster/TrueMarble.8km.5400x2700.tif
dans une table Postgis (nom de la table: monde_raster) en choisissant:
    • Le bon SRID (utilisation de gdalinfo pour lire le SRID)
    • 3 overviews de niveau 2, 4, 8
    • une taille de tuile de 100x100 pixels
    • la création des contraintes 
    
raster2pgsql -M -I -C -Y -s 4326 -t 100x100 -l 2,4,8 formation_postgis/data/raster/TrueMarble.8km.5400x2700.tif monde_raster | psql tp    
    
2°) Vérifier les métadonnées:
    • de la table monde_raster
    • des tables d'overview

select * from raster_columns;
select * from raster_overviews;

3°) Afficher dans QGis:

• Ouvrir QGis
• Installer le plugin de visu raster postgis: Plugin -> Plugin Python -> Load Postgis Raster to QGIS
• Verifier sa présence dans Couches (ajouter couche raster Postgis)
• Ajouter la couche (jouer avec le plugin).

4°) Afficher dans MapServer

• Vérifier le demarrage d'Apache, la bonne installation de Mapserver:
La requete suivante doit lister un message d'erreur. (La source de la page indique la version de mapserver):
http://localhost/cgi-bin/mapserv.exe?mode=map

• Créer un fichier mapfile c:/test.map contenant le texte suivant:

MAP
    SIZE 500 500
  	extent -180.0 -90.0 180.0 90.0
  	
  	LAYER
  	    NAME "mondo"
  	    TYPE raster
  	    DATA "PG:host=localhost port=5432 dbname='tp' user='nicolas' table='monde_raster' mode='2'"
  	    PROCESSING "NODATA=0"
  	    PROCESSING "SCALE=AUTO"
		STATUS default
  	END

END

• Dans un navigateur, appeler l'adresse:
http://localhost/cgi-bin/mapserv?mode=map&map=c:/test.map
Une image montrant le raster chargé doit apparaitre.
